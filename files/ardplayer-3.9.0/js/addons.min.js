(function(b,e){var d=function(){this._lastTimeUpdate=-1;this._oldBufferingValue=this._isBuffering=this._isPlaying=!1},c=d.prototype=new b.AbstractCorePlugin;c.super_register=c.register;c.register=function(a){this.super_register(a);this.register_event(b.Player.EVENT_INIT,this.eventInitPlayer);this.register_event(b.Player.EVENT_LOAD_STREAM,this.eventLoadStream);this.register_event(b.Player.EVENT_PLAY_STREAM,this.eventPlayStream);this.register_event(b.Player.EVENT_PAUSE_STREAM,this.eventPauseStream);
this.register_event(b.Player.EVENT_END_STREAM,this.eventEndStream);this.register_event(b.Player.EVENT_UPDATE_STREAM_TIME,this.eventUpdateStreamTime);this.register_event(b.Player.EVENT_BUFFERING,this.eventBuffering);this.register_event(b.PlayerPixelController.SUPER_SCRUBBAR_CHANGE_POSITION_FORWARD,this.eventSeek);this.register_event(b.PlayerPixelController.SUPER_SCRUBBAR_CHANGE_POSITION_REWIND,this.eventSeek);e(window).on("unload",this.onUnload.bind(this));this.log("Plugin registered: AddonATIPixel")};
c.super_dispose=c.dispose;c.dispose=function(){this.super_dispose();e(window).off("unload",this.onUnload)};c.onUnload=function(){this.updatePlayStatePixel()};c.eventInitPlayer=function(){this.log("eventInitPlayer")};c.eventLoadStream=function(){this.log("eventLoadStream");this._isBuffering=!1;this._clipTitle=this.getClipTitle()};c.eventSeek=function(){this.log("eventSeek");this._generateHIT("move")};c.eventUpdateStreamTime=function(a){var h=Math.round(a.currentTime);if(this._lastTimeUpdate!=h)this._lastTimeUpdate=
h,this.log("eventUpdateStreamTime: "+a.currentTime+" => "+this._lastTimeUpdate),this.updatePlayStatePixel()};c.eventPlayStream=function(){this.log("eventPlayStream");this._isPlaying=!0};c.eventBuffering=function(a){this.log("eventBuffering:"+a.isBuffering);this._isBuffering=a.isBuffering;this.updatePlayStatePixel()};c.updatePlayStatePixel=function(){if(this._isPlaying){if(0<this._lastTimeUpdate)this._oldBufferingValue!=this._isBuffering?(this._oldBufferingValue=this._isBuffering,this._generateHIT(this._isBuffering?
"play&buf=1":"info&buf=0")):this._generateHIT("play")}else this._generateHIT("pause")};c.eventPauseStream=function(){this.log("eventPauseStream");this._isPlaying=!1;this.updatePlayStatePixel()};c.eventEndStream=function(){this.log("eventEndStream");this._isPlaying=!1;this._generateHIT("stop")};c.getClipTitle=function(){var a=this._player.getCtrl().model,h=a.mediaCollection,a=a.playerConfig._pixelConfig||null;if(h._pixelConfig)a=h._pixelConfig;if(a&&"[object Array]"===Object.prototype.toString.call(a))for(var f=
0;f<a.length;f++)if(h=a[f],"ATI"===h.tracker)return h.clipTitle;return""};c._generateHIT=function(a){var h=this._player,f=h.getCtrl(),g=h.model,c=g.mediaCollection,b="",b=f.getStreamByQualityIndex(h.viewCtrl.representationQuality),b=b._stream instanceof Array?b._stream[0]:b._stream,f=c._type,f=f+("&plyr="+h.getId()),h="unknown",h=(h=this._clipTitle)?h:b,e="";c._isLive||(e=Math.round(Math.min(g.getDuration(),86400)));var g="rmp="+Math.round(g.getTime()),g=g+"&rmpf=0&rmbufp=0",d="clip";c._isLive&&(d=
"live");c="";c=b.toLowerCase().substr(b.lastIndexOf(".")+1);this.log("xt_rm("+f+",,"+h+","+a+",,0,"+e+","+g+",,,int,"+d+",,"+c+")");"function"===typeof xt_rm&&xt_rm(f,"",h,a,"",0,e,g,"","","int",d,"",c)};c.isBuffering=function(){var a=this._player.viewCtrl.buffering;return a?!a.isHiddenByClass():!1};c.log_super=c.log;c.log=function(){};b.AddonATIPixel=d})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e,d){var c=function(){this.__buffering=!1;this.__tagQueue=[];this.__delayMap={};this.__hasDuration=!1},a=c.prototype=new b.AbstractCorePlugin;a.super_register=a.register;a.register=function(a){this.super_register(a);this.register_event(b.Player.EVENT_PLAY_STREAM,this.eventPlayStream);this.register_event(b.Player.EVENT_PAUSE_STREAM,this.eventPauseStream);this.register_event(b.Player.EVENT_END_STREAM,this.eventEndStream);this.register_event(b.Player.EVENT_UPDATE_STREAM_DURATION,this.eventUpdateStreamDuration);
this.register_event(b.Player.EVENT_BUFFERING,this.eventBuffering);this.register_event(b.PlayerPixelController.SUPER_SCRUBBAR_CHANGE_POSITION_FORWARD,this.eventSeek);this.register_event(b.PlayerPixelController.SUPER_SCRUBBAR_CHANGE_POSITION_REWIND,this.eventSeek);e(window).on("unload",this.onUnload.bind(this));this.ati_tag=new ATInternet.Tracker.Tag(ati_options||{});this.log("Plugin registered: AddonATIPixel (SmartTag)")};a.super_dispose=a.dispose;a.dispose=function(){this.super_dispose();e(window).off("unload",
this.onUnload)};a.onUnload=function(){this.ati_tag&&this.ati_tag.richMedia&&this.ati_tag.richMedia.removeAll()};a.eventSeek=function(){this._send("move")};a.eventUpdateStreamDuration=function(){if(!this.__hasDuration)for(this.__hasDuration=!0;0<this.__tagQueue.length;){var a=this.__tagQueue.shift();this._send(a.action,a.params)}};a.eventPlayStream=function(){this._sendDelayed("pps","play")};a.eventBuffering=function(a){if(this.__buffering!==a.isBuffering)this.__buffering=a.isBuffering,this._send("info",
{isBuffering:a.isBuffering})};a.eventPauseStream=function(){this._sendDelayed("pps","pause")};a.eventEndStream=function(){this._sendDelayed("pps","stop")};a.getPixelField=function(a,f){var g=this._player.getCtrl().model,c=g.mediaCollection,g=g.playerConfig._pixelConfig||null;if(c._pixelConfig)g=c._pixelConfig;if(g&&"[object Array]"===Object.prototype.toString.call(g))for(var b=0;b<g.length;b++)if(c=g[b],"ATI"===c.tracker){if(c.hasOwnProperty(a))return g=c[a],"boolean"===f?"true"===(g||"").toString().toLowerCase():
"string"===f?(g||"").toString():c[a];break}return null};a.addMetaFieldIfSet=function(a,f,c,b){(b=this.getPixelField(f,b))?a[f]=b:void 0!==c&&(a[f]=c)};a._sendDelayed=function(a,f,c){this.__delayMap[a]&&clearTimeout(this.__delayMap[a]);this.__delayMap[a]=setTimeout(function(a,f,c){delete this.__delayMap[a];this._send(f,c)}.bind(this),1E3,a,f,c)};a._send=function(a,f){var c=this._player,b=c.getCtrl().model,e=b.mediaCollection,d=0;e._isLive||(d=Math.round(Math.min(b.__duration,86400))||0);if(0===d&&
!e._isLive)this.log("Duration is mandatory for OD clips, caching tag."),this.__tagQueue.push({action:a,params:f});else{this.log("_send called",a,f);if(!this._hasTag)this._hasTag=!0,b={},this.addMetaFieldIfSet(b,"duration",(d||"").toString(),"string"),this.addMetaFieldIfSet(b,"broadcastMode",e._isLive?"live":"clip"),this.addMetaFieldIfSet(b,"mediaType",e._type||"unknown"),this.addMetaFieldIfSet(b,"playerId",c._id||""),this.addMetaFieldIfSet(b,"mediaLevel2"),this.addMetaFieldIfSet(b,"mediaLabel",""),
this.addMetaFieldIfSet(b,"mediaTheme1"),this.addMetaFieldIfSet(b,"mediaTheme2"),this.addMetaFieldIfSet(b,"mediaTheme3"),this.addMetaFieldIfSet(b,"previousMedia"),this.addMetaFieldIfSet(b,"refreshDuration","5","string"),this.addMetaFieldIfSet(b,"isEmbedded",!1,"boolean"),this.addMetaFieldIfSet(b,"webdomain"),this.ati_tag&&this.ati_tag.richMedia&&(this.log("this.ati_tag.richMedia.add",b),this.ati_tag.richMedia.add(b));e={action:a};this.addMetaFieldIfSet(e,"playerId",c._id||"");this.addMetaFieldIfSet(e,
"mediaLabel","");this.addMetaFieldIfSet(e,"mediaTheme1");this.addMetaFieldIfSet(e,"mediaTheme2");this.addMetaFieldIfSet(e,"mediaTheme3");if("info"===a&&f)for(var m in f)e[m]=f[m];this.ati_tag&&this.ati_tag.richMedia&&(this.log("this.ati_tag.richMedia.send",e),this.ati_tag.richMedia.send(e))}};a.log_super=a.log;a.log=function(){d.log.apply(d.log,[].concat("[AddonATIPixel]\t",arguments))};b.AddonATIPixel=c})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e,d){var c=function(){},e=c.prototype=new b.AbstractCorePlugin;c.CLASS_DEBUG="class-debug";c.CLASS_DEBUG_SELECTED="class-debug-selected";e.super_register=e.register;e.register=function(a){this.super_register(a);this.register_event(b.Player.EVENT_INIT,this.eventInitPlayer);this.register_event(b.Player.EVENT_KEYBOARD_RELEASE,this.eventKeyboardRelease);this.register_event(b.Player.EVENT_LOAD_STREAM,this.eventLoadStream);this.register_event(b.Player.EVENT_STOP_STREAM,this.eventStopStream);
this.register_event(b.Player.EVENT_END_STREAM,this.eventEndStream);this.register_event(b.Player.EVENT_UPDATE_STREAM_TIME,this.eventUpdateStreamTime);this.register_event(b.Player.VIEW_RESTORE_DEFAULTS,this.eventViewRestoreDefaults);this.register_event(b.Player.SETUP_VIEW,this.eventSetupView);this.register_event(b.Player.SETUP_VIEW_COMPLETE,this.eventViewSetupComplete);this.displayDebugger=!0;this.log("Plugin registered: AddonDebug")};e.eventSetupView=function(a){this.log("eventSetupView");this.setupView(a)};
e.eventKeyboardRelease=function(){this.log("eventKeyboardRelease")};e.eventViewSetupComplete=function(){this.log("eventViewSetupComplete")};e.eventViewRestoreDefaults=function(){this.log("eventViewRestoreDefaults")};e.eventInitPlayer=function(){this.log("eventInitPlayer")};e.eventLoadStream=function(){this.log("eventLoadStream")};e.eventUpdateStreamTime=function(a){this.log("eventUpdateStreamTime: "+a.currentTime)};e.eventStopStream=function(){this.log("eventStopStream")};e.eventEndStream=function(){this.log("eventEndStream")};
e.setupView=function(a){var b=a.controller,f=this;this.buttonInstance=b.generateButton(c.CLASS_DEBUG,a.container,b,null,null).attr({title:"Debugger de-/aktivieren",role:"button",tabindex:"0",onClick:"this.blur(); return false;"}).addClass("ardplayer-button-border-width-0 ardplayer-tabindex-focus "+c.CLASS_DEBUG_SELECTED).text("D").off(b.clickEventName).on(b.clickEventName,function(){f.toggleDebugger();return!1})};e.toggleDebugger=function(){this.displayDebugger=!this.displayDebugger;if(this.buttonInstance)switch(this.displayDebugger){case !0:this.buttonInstance.addClass(c.CLASS_DEBUG_SELECTED);
break;case !1:this.buttonInstance.removeClass(c.CLASS_DEBUG_SELECTED)}};e.log_super=e.log;e.log=function(a){this.displayDebugger&&d&&d.log&&d.log("[AddonDebug]:\t"+a)};b.AddonDebug=c})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(){},c=d.prototype=new b.AbstractCorePlugin;d.CLASS_SUBTITEL="ardplayer-btn-subtitle";d.CLASS_SUBTITEL_PLACEHOLDER="ardplayer-untertitel-ebu";d.CLASS_SUBTITLE_SELECTED="toggle";d.ERROR_LOADING_SUBTITLE_XML="Ein Fehler beim Laden der Untertitel-Datei ist aufgetreten.";d.EVENT_HIDE_SUBTITLES="AddonUntertitel.hideSubtitles";d.EVENT_SHOW_SUBTITLES="AddonUntertitel.showSubtitles";d.EVENT_TGGL_SUBTITLES="AddonUntertitel.toggleSubtitles";c.super_register=c.register;c.register=
function(a){this.super_register(a);this.ADDON_NAME="AddonUntertitel_ebu_tt";this.VERSION="1.6";this.vAlign="bottom";a=b.GlobalModel.getInstance();a.isWindowsPhone||a.isIPhoneDevice||a.isIPodDevice?this.log("Plugin skipped: AddonUntertitel_ebu_tt"):(this.register_event(b.Player.EVENT_INIT,this.eventInitPlayer),this.register_event(b.Player.EVENT_KEYBOARD_RELEASE,this.eventKeyboardRelease),this.register_event(b.Player.EVENT_LOAD_STREAM,this.eventLoadStream),this.register_event(b.Player.EVENT_STOP_STREAM,
this.eventStopStream),this.register_event(b.Player.EVENT_END_STREAM,this.eventEndStream),this.register_event(b.Player.EVENT_UPDATE_STREAM_TIME,this.eventUpdateStreamTime),this.register_event(b.Player.VIEW_RESTORE_DEFAULTS,this.eventViewRestoreDefaults),this.register_event(b.Player.SETUP_VIEW,this.eventSetupView),this.register_event(b.Player.SETUP_VIEW_COMPLETE,this.eventViewSetupComplete),this.register_event(b.Player.VIEW_CTRLBAR_MOVE,this.eventLiftSubtitles),this.register_event(b.Player.TOGGLE_FULLSCREEN,
this.eventToggleFullscreen),this.register_event(d.EVENT_SHOW_SUBTITLES,this.eventShowSubtitles),this.register_event(d.EVENT_HIDE_SUBTITLES,this.eventHideSubtitles),this.register_event(d.EVENT_TGGL_SUBTITLES,this.eventToggleSubtitles),this.log("Plugin registered: AddonUntertitel_ebu_tt"))};c.super_dispose=c.dispose;c.dispose=function(){this.ebuSubtitleController&&this.ebuSubtitleController.dispose();this.ebuSubtitleController=null;this.super_dispose()};c.eventToggleFullscreen=function(a){if(this.displaySubtitles&&
this.ebuSubtitleController&&this.ebuSubtitleController._lastCaptioningElement)this.ebuSubtitleController._lastCaptioningElement.style={},a=e.extend(e.Event(b.EbuSubtitleController.TEXT_VALUE_CHANGED),{changedObject:this.ebuSubtitleController._lastCaptioningElement}),e(this.ebuSubtitleController).trigger(a)};c.eventShowSubtitles=function(){this.showSubtitles();this.showSubtitleState(!0)};c.eventHideSubtitles=function(){this.hideSubtitles();this.showSubtitleState(!1)};c.eventToggleSubtitles=function(a){this.toggleSubtitles(a?
a.preventTrackingPixel||!1:!1)};c.eventSetupView=function(a){this.setupView(a)};c.eventKeyboardRelease=function(a){"u"==a.shortcut&&(!1===this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_ACTIVATION):!0===this.displaySubtitles&&this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_DEACTIVATION),this.toggleSubtitles(),this.showSubtitleState(this.getISubTitleDivVisible()))};c.eventViewSetupComplete=function(){this.displaySubtitles?
this.showSubtitleState(!0):this.showSubtitleState(!1)};c.eventViewRestoreDefaults=function(){this.hideSubtitles()};c.eventInitPlayer=function(){this.ebuSubtitleController=b.EbuSubtitleController.getInstance(this._player);this.ebuSubtitleControllerBindEventHandler()};c.eventLoadStream=function(){if(!this._loadTriggered)this._loadTriggered=!0,this.loadSubtitles()};c.eventUpdateStreamTime=function(a){!0==this.getISubTitleDivVisible()&&this.ebuSubtitleController.updateTimeFromPlyrCtrl(a.currentTime)};
c.eventStopStream=function(){this.hideSubtitles();if(this.ebuSubtitleController)this.ebuSubtitleController._lastCaptioningElement=null};c.eventEndStream=function(){this.hideSubtitles()};c.eventLiftSubtitles=function(a){!0==this.getISubTitleDivVisible()&&"bottom"==this.vAlign&&this.subtitlePlaceHolder.css({top:"",bottom:parseInt(a.ctrlBarHeight)})};c.setupView=function(a){function c(a,b,f){g.subtitlePlaceHolder=a.generateDiv(d.CLASS_SUBTITEL_PLACEHOLDER,a.viewport,a,b,f);a.addGeneratedElemetToList(a,
d.CLASS_SUBTITEL_PLACEHOLDER,d.CLASS_SUBTITEL_PLACEHOLDER,g.subtitlePlaceHolder,f,!1,!1,!1,!1,!1,!0);g.hideSubtitles();g.subtitlePlaceHolder.off(a.clickEventName).on(a.clickEventName,function(){g._player.getCtrl().togglePlay();return!1}).attr("aria-live","off");return g.subtitlePlaceHolder}function f(a,f,c){if(!e.isBlank(j.getSubtitleUrl())&&!j.getIsLive()){var h=function(a){if(13==a.keyCode)return a.preventDefault(),i(a,!1)}.bind(this),i=function(a,f){if(!1!==f)try{g.subtitle.blur()}catch(c){}!1===
g.displaySubtitles?g._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_ACTIVATION):!0===g.displaySubtitles&&g._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_DEACTIVATION);g.toggleSubtitles();return g._player.viewCtrl.tabFadePrevention=!1}.bind(this);g.subtitle=a.generateButton(d.CLASS_SUBTITEL,k,a,f,c).attr({title:"Untertitel ein-/ausblenden [(STRG +) U]",role:"menuitem","aria-pressed":!1,tabindex:"0"}).addClass("ardplayer-button-border-width-0 ardplayer-tabindex-focus").on("keydown",
h).on(a.clickEventName,i).on("mouseover mouseout touchstart touchend",function(a){a.preventDefault();e(a.target).toggleClass("hover")});return g.subtitle}return null}var g=this,j=this._player.model.mediaCollection,i=a.controller,k=a.container;this.displaySubtitles=this._player.model.playerConfig.getShowSubtitelAtStart();a=b.GlobalModel.getInstance();if(a.hasSubtitlePreference())this.displaySubtitles=a.getSubtitleEnabled();this.displaySubtitles=this.displaySubtitles&&!this._player.model.mediaCollection.getIsLive();
j.getType()===b.MediaCollection.TYPE_VIDEO&&(f(i),c(i))};c.getISubTitleDivVisible=function(){var a=!1;this.subtitle&&(a=this.subtitle.hasClass(d.CLASS_SUBTITLE_SELECTED));return a};c.hideSubtitles=function(){this.subtitlePlaceHolder&&this.subtitlePlaceHolder.hideWithClass()};c.showSubtitles=function(){this.subtitlePlaceHolder&&this.subtitlePlaceHolder.showWithClass()};c.showSubtitleState=function(a){this.displaySubtitles=a;if(this.subtitle){switch(a){case !0:this.subtitle.addClass(d.CLASS_SUBTITLE_SELECTED);
break;case !1:this.subtitle.removeClass(d.CLASS_SUBTITLE_SELECTED)}this.subtitle.attr({"aria-pressed":a})}};c.toggleSubtitles=function(a){if(this._player&&this._player.getCtrl()){this.displaySubtitles=!this.displaySubtitles;b.GlobalModel.getInstance().setSubtitleEnabled(this.displaySubtitles);var c=this.displaySubtitles;e.each(b.PlayerModel.getAllPlayer(this._player),function(a,f){f.dispatchCustomEvent(c?d.EVENT_SHOW_SUBTITLES:d.EVENT_HIDE_SUBTITLES)});this.showSubtitleState(this.displaySubtitles);
var f=this._player.getCtrl();this.displaySubtitles?(f.showSubtitles(),this.showSubtitles()):(f.hideSubtitles(),this.hideSubtitles());a||(this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_ACTIVATION):this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_DEACTIVATION))}};c.loadSubtitles=function(){var a=this._player.model.mediaCollection;e.isBlank(a.getSubtitleUrl())?this.displaySubtitles=!1:this.ebuSubtitleController.loadTrackXML(this._player.viewCtrl.viewport,
a.getSubtitleUrl())};c.ebuSubtitleControllerBindEventHandler=function(){var a=this;e(this.ebuSubtitleController).on(b.EbuSubtitleController.TEXT_VALUE_CHANGED,function(c){if(a.subtitlePlaceHolder){var f=e(a.subtitlePlaceHolder);this._lastCaptioningElement!=c.changedObject&&(f.empty(),e(f).append(c.changedObject.text));var b=null!=c.changedObject.divFontSize?parseFloat(c.changedObject.divFontSize)/100:null,d=null!=c.changedObject.pFontSize?parseFloat(c.changedObject.pFontSize)/100:null,i=null!=c.changedObject.spanFontSize?
parseFloat(c.changedObject.spanFontSize)/100:null,d=b=a._player.viewCtrl.viewport.height()/30*((0!=b||null!=b||NaN!=b)&&null==d&&null==i?b:1);"2c"==c.changedObject.spanFontSize&&(i=1.6);null!=i&&(d=b*i);10>d?(e(f).children().css("visibility","hidden"),e(".ardplayer-btn-subtitle").css("display","none")):(e(f).children().css("visibility","visible"),e(".ardplayer-btn-subtitle").css("display","inline-block"));e(f).children().css("font-size",b);a.vAlign=c.changedObject.vAlign;"top"==c.changedObject.vAlign?
e(f).css({top:0,bottom:""}):"bottom"==c.changedObject.vAlign&&(c=parseInt(a._player.viewCtrl.viewport.height())-parseInt(a._player.viewCtrl.mainControlbar.position().top),e(f).css({top:"",bottom:c}));e(f).isHiddenByClass()&&a.subtitlePlaceHolder.showWithClass()}});e(this.ebuSubtitleController).on(b.EbuSubtitleController.HIDE_SUBTITLES,function(){a.subtitlePlaceHolder&&!a.subtitlePlaceHolder.isHiddenByClass()&&a.subtitlePlaceHolder.hideWithClass()});e(this.ebuSubtitleController).on(b.EbuSubtitleController.ERROR_LOADING_XML,
function(){a.subtitle&&(a.subtitle.hideWithClass(),a._player.errorCtrl.throwError(d.ERROR_LOADING_SUBTITLE_XML,b.ErrorController.IS_CRITICAL_NO),e(a.ebuSubtitleController).off())})};b.AddonUntertitel_ebu_tt=d})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(a){if(void 0==d.playerIDs)d.playerIDs={};if(void 0==d.players)d.players=[];var c=void 0;a&&a instanceof b.Player&&(c=a.getId());void 0==c&&b.ErrorController.getInstance().throwError(b.ErrorController.NO_PLAYER_DEFINED,b.ErrorController.IS_CRITICAL_YES);if(d.playerIDs[c])return d.playerIDs[c];d.playerIDs[c]=this;d.players.push(a);this.playerID=c;this.player=a;this.initialize()};d.getInstance=function(a){return new d(a)};d.resetSingleton=function(){d.instance=void 0};var c=
d.prototype;c.initialize=function(){this._lastCaptioningElement=this.trackData=this.subTitleObjects=this.loadedXML=this.subTitleURL=this.playingPlayer=null};c.dispose=function(){this.playerID&&(d.playerIDs[this.playerID]=null)};c.loadTrackXML=function(a,c){this.trackData={};this.trackData.captions=[];this.playingPlayer=a;this.subTitleURL=c;e.ajax({type:"GET",url:c,dataType:"xml",encoding:"UTF-8",error:b.Delegate.create(this,this.xmlError),complete:b.Delegate.create(this,this.xmlComplete),success:b.Delegate.create(this,
this.xmlSuccess)})};c.xmlComplete=function(){};c.xmlError=function(){a(this,d.ERROR_LOADING_XML)};c.xmlSuccess=function(a,c){this.loadedXML=a;if(null!=a&&"success"==c){var b=e('<li><a class="track" type="application/ttaf+xml" href="'+this.subTitleURL+'" lang="de"  data-enabled="enabled" >EBUTT/ttml file</a></li>');e(this.playingPlayer).append(b.hideWithClass());var d=this;try{for(var i=d.loadedXML.documentElement.namespaceURI,k={},b={},m=this.getElementsWithNS(d.loadedXML,i,"region"),l=0;l<m.length;l++){var p=
m[l],n=d.sp_getXmlAttr(p,"id");b[n]="after"==d.sp_getXmlAttr(p,"displayAlign")?"bottom":"before"==d.sp_getXmlAttr(p,"displayAlign")?"top":d.sp_getXmlAttr(p,"displayAlign")}for(var o=this.getElementsWithNS(d.loadedXML,i,"style"),l=0;l<o.length;l++){var p=o[l],n=d.sp_getXmlAttr(p,"id"),r="";e.each(p.attributes,function(a,c){var b=d.sp_getAttrRawName(c),f=c.value;if("id"!=b){"fontSize"==b&&(b="font-size",f=f.toLowerCase(),"1c"==f?f="100%":"2c"==f&&(f="160%"));if("lineHeight"==b&&(b="line-height","normal"==
f))return;"textAlign"==b&&(b="text-align");"fontFamily"==b&&(b="font-family");"backgroundColor"==b&&(7<f.length&&(b=f.substr(7,9),Math.round(100*(parseInt(b,16)/255)),navigator.userAgent.match(/msie 8.0/i),f=f.substr(0,7)),b="background-color");r+=b+":"+f+"; "}});k[n]=r}for(var t=this.getElementsWithNS(d.loadedXML,i,"div"),m=null,n=0;n<t.length;n++)m=d.getFontSize(t[n],o);for(var u=this.getElementsWithNS(d.loadedXML,i,"p"),l=0;l<u.length;l++){var p=u[l],i=l+1,n=d.sp_getXmlAttr(p,"id"),s=d.sp_getXmlAttr(p,
"begin"),w=d.sp_getXmlAttr(p,"end"),z=d.sp_getXmlAttr(p,"style"),A=d.sp_getXmlAttr(p,"region"),B=d.sp_getXmlAttr(p,"fontSize"),x=null,v=k[z];"undefined"==typeof v&&(v="");var v=v+"margin-left: 10%; margin-right: 10%;",q='<p id="tt'+i+'" style="'+v+'">';e.each(p.childNodes,function(a,c){var b=d.sp_getNodeRawName(c);if("#text"==b)return!0;if("span"==b){b=d.sp_getXmlAttr(c,"style");x=d.getFontSize(c,o);b=k[b];"undefined"==typeof b&&(b="");var f=e(c).text();-1==f.indexOf("<span>")&&(f="&nbsp;"+f);q+=
'<span style="'+b+'">'+f+"</span>";return!0}if("br"==b)return b=q.lastIndexOf("</span>"),q=[q.slice(0,b),"&nbsp;",q.slice(b)].join(""),q+="<br/>",!0});var y=q.lastIndexOf("</span>"),q=[q.slice(0,y),"&nbsp;",q.slice(y)].join(""),q=q+"</p>",s=d.sp_srtTime2Sec(s),w=d.sp_srtTime2Sec(w);d.trackData.captions.push({id:"tt"+i,startTime:s,endTime:w,text:q,vAlign:b[A],divFontSize:m,pFontSize:B,spanFontSize:x})}}catch(C){}}};c.getElementsWithNS=function(a,b,c){return a.getElementsByTagNameNS?a.getElementsByTagNameNS(b,
c):a.getElementsByTagName("tt:"+c)};c.sp_getAttrRawName=function(a){var a=a.name,b=a.indexOf(":");0<=b&&(a=a.substr(b+1));return a};c.sp_getNodeRawName=function(a){var a=a.nodeName,b=a.indexOf(":");0<=b&&(a=a.substr(b+1));return a};c.sp_getXmlAttr=function(a,b){var c=null;e.each(a.attributes,function(a,d){var e=d.name,h=e.indexOf(":");0<=h&&(e=e.substr(h+1));if(e==b)return c=d.value,!1});return c};c.getFontSize=function(a,b){for(var c=null,d=this.sp_getXmlAttr(a,"style"),e=0;e<b.length;e++){var k=
b[e];this.sp_getXmlAttr(k,"id")==d&&(c=this.sp_getXmlAttr(k,"fontSize"))}return c};c.sp_srtTime2Sec=function(a){var b;b=0+3600*a.substr(0,2);b+=60*a.substr(3,2);b+=1*a.substr(6,2);b+=0.001*a.substr(9,3);36E3<=b&&(b-=36E3);return b};c.updateTimeFromPlyrCtrl=function(b){for(var c=this.trackData.captions,e=null,e=[],j=0;j<c.length;j++){var i=c[j];if(b>=i.startTime&&b<=i.endTime&&(e.push(j),this.activeSubtitle!=j))this.activeSubtitle=1<e.length?e[e.length-1]:j}if("object"===typeof c[this.activeSubtitle])b>=
c[this.activeSubtitle].startTime&&b<=c[this.activeSubtitle].endTime?(e=c[this.activeSubtitle],a(this,d.TEXT_VALUE_CHANGED,{changedObject:e}),this._lastCaptioningElement=e):a(this,d.HIDE_SUBTITLES,{changedObject:null})};var a=function(a,b,c){b=e.extend(e.Event(b),c);e(a).trigger(b)};d.TEXT_VALUE_CHANGED="textValueChanged";d.HIDE_SUBTITLES="hideSubtitles";d.ERROR_LOADING_XML="errorLoadingXml";b.EbuSubtitleController=d})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(){},c=d.prototype=new b.AbstractCorePlugin;d.CLASS_SUBTITEL="ardplayer-btn-subtitle";d.CLASS_SUBTITEL_PLACEHOLDER="ardplayer-untertitel";d.CLASS_SUBTITLE_SELECTED="toggle";d.TYPE_ALTERNATIVE_MC="untertitel";c.super_register=c.register;c.register=function(a){this.super_register(a);this.ADDON_NAME="AddonLiveUntertitel";this.VERSION="1.0";this.register_event(b.Player.EVENT_KEYBOARD_RELEASE,this.eventKeyboardRelease);this.register_event(b.Player.SETUP_VIEW,this.eventSetupView);
this.register_event(b.Player.SETUP_VIEW_COMPLETE,this.eventViewSetupComplete);this.register_event(b.Player.EVENT_LOAD_STREAM,this.eventLoadStream);this.log("Plugin registered: AddonLiveUntertitel")};c.super_dispose=c.dispose;c.dispose=function(){this.super_dispose()};c.eventSetupView=function(a){this.setupView(a)};c.eventKeyboardRelease=function(a){"u"==a.shortcut&&(!1===this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_ACTIVATION):!0===
this.displaySubtitles&&this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_DEACTIVATION),this.toggleSubtitles())};c.eventViewSetupComplete=function(){this.displaySubtitles?this.showSubtitleButtonState(!0):this.showSubtitleButtonState(!1)};c.eventLoadStream=function(){if(!this._player.model.mediaCollection.hasAlternativeMediaArrayByType(d.TYPE_ALTERNATIVE_MC)&&this.subtitle)this.subtitle.off().remove(),this.subtitle=null};c.setupView=function(a){function c(a,h,l){if(g.hasAlternativeMediaArrayByType(d.TYPE_ALTERNATIVE_MC)){var j=
function(a){if(13==a.keyCode)return a.preventDefault(),n(a,!1)}.bind(this),n=function(a,c){if(!1!==c)try{f.subtitle.blur()}catch(d){}!1===f.displaySubtitles?f._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_ACTIVATION):!0===f.displaySubtitles&&f._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_DEACTIVATION);f.toggleSubtitles();return f._player.viewCtrl.tabFadePrevention=!1}.bind(this);f.subtitle=a.generateButton(d.CLASS_SUBTITEL,
i,a,h,l).attr({title:"Untertitel ein-/ausblenden [(STRG +) U]",role:"menuitem","aria-pressed":!1,tabindex:"0"}).on("keydown",j).on(a.clickEventName,n).on("mouseover mouseout touchstart touchend",function(a){a.preventDefault();e(a.target).toggleClass("hover")});return f.subtitle}return null}var f=this,g=this._player.model.mediaCollection,j=a.controller,i=a.container;if(g.getType()===b.MediaCollection.TYPE_VIDEO){this.displaySubtitles=this._player.model.playerConfig.getShowSubtitelAtStart();a=b.GlobalModel.getInstance();
if(a.hasSubtitlePreference())this.displaySubtitles=a.getSubtitleEnabled();a.setSubtitleEnabled(this.displaySubtitles);g.hasAlternativeMediaArrayByType(d.TYPE_ALTERNATIVE_MC)&&(g.setUseAlternativeMediaArrayType(this.displaySubtitles?d.TYPE_ALTERNATIVE_MC:!1),c(j))}};c.hideSubtitles=function(){this._playMediaArray(!1)};c.showSubtitles=function(){this._playMediaArray(d.TYPE_ALTERNATIVE_MC)};c._playMediaArray=function(a){this._player.model.mediaCollection.setUseAlternativeMediaArrayType(a);this._player.model.playerConfig.setAutoPlay(!0);
this._player.viewCtrl.restoreDefaults();this._player.viewCtrl.updateOptionButtonVisibility();this._player.getCtrl().representationChanged()};c.showSubtitleButtonState=function(a){this.displaySubtitles=a;if(this.subtitle){switch(a){case !0:this.subtitle.addClass(d.CLASS_SUBTITLE_SELECTED);break;case !1:this.subtitle.removeClass(d.CLASS_SUBTITLE_SELECTED)}this.subtitle.attr({"aria-pressed":a})}};c.toggleSubtitles=function(a){if(this._player&&this._player.getCtrl()){this.displaySubtitles=!this.displaySubtitles;
b.GlobalModel.getInstance().setSubtitleEnabled(this.displaySubtitles);var c=this.displaySubtitles;e.each(b.PlayerModel.getAllPlayer(this._player),function(a,b){b.dispatchCustomEvent(c?d.EVENT_SHOW_SUBTITLES:d.EVENT_HIDE_SUBTITLES)});this.showSubtitleButtonState(this.displaySubtitles);this.displaySubtitles?this.showSubtitles():this.hideSubtitles();a||(this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_ACTIVATION):this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_DEACTIVATION))}};
b.AddonLiveUntertitel=d})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(){var a=0,b="",d="",e=null,i=!1,k=-1;return{parse:function(c){c.hasOwnProperty("_chapterTime")&&(a=c._chapterTime||0);c.hasOwnProperty("_chapterTitle")&&(b=c._chapterTitle||"");c.hasOwnProperty("_chapterImg")&&(d=c._chapterImg||"");return this},getSeconds:function(){return a},hasTitle:function(){return!!b.trim()},getTitle:function(){return b},hasPreloadImage:function(){return!!d.trim()},getPreloadImageUrl:function(){return this.hasPreloadImage()?d.replace(/#.*$/,""):
""},setPreloadedImage:function(a,b,c){e=a;i=b;k=c;return this},hasImage:function(){return!!e},getImageSrc:function(){return!this.hasImage()?"":e.src},getSpritesheetCoordinates:function(){if(!e)return!1;var a,b,f,h;i?(h=c.SPRITESHEET_COLUMN_COUNT,a=e.width/h,b=9*(a/16),f=Math.floor(k%h)*a,h=Math.floor(k/h)*b):(a=/#xybh=(\d+),(\d+),(\d+),(\d+)$/,a.test(d)?(b=d.match(a),f=b[1],h=b[2],a=b[3],b=b[4]):(h=f=0,a=e.width,b=e.height));return{x:f,y:h,w:a,h:b}}}},c=function(){this._imageQueue=[];this._chapters=
[];this._duration=0;this._drawingComplete=!1},a=c.prototype=new b.AbstractCorePlugin;c.TXT_MAX_WIDTH=160;c.CSS_CLASS_MARKER_CONTAINER="sprungmarken";c.CSS_CLASS_MARKER="sprungmarke";c.CSS_CLASS_POPUP="popup";c.CSS_CLASS_POPUP_ARROW="arrow";c.SPRITESHEET_COLUMN_COUNT=1;a.super_register=a.register;a.register=function(a){this.super_register(a);if(a.model.playerConfig.getChaptersEnabled()){this._isMobile=b.GlobalModel.getInstance().isMobileDevice;this._markerWidth=7;if(this._isMobile)this._markerWidth=
14;a.model.mediaCollection.getIsLive()||(this.register_event(b.Player.EVENT_READY,this.playerEventReadyHandler),this.register_event(b.Player.EVENT_PLAY_STREAM,this.playStreamEventHandler),this.register_event(b.Player.EVENT_CTRLBAR_FADEIN_START,this.fadeInCtrlbarStart),this.register_event(b.Player.EVENT_CTRLBAR_FADEOUT_START,this.fadeOutCtrlbarStart))}};a.fadeInCtrlbarStart=function(){this._uiJumpMarkContainer&&this._uiJumpMarkContainer.children().removeClass("fadeout")};a.fadeOutCtrlbarStart=function(){this._uiJumpMarkContainer&&
this._uiJumpMarkContainer.children().addClass("fadeout")};a.super_dispose=a.dispose;a.dispose=function(){this.super_dispose();this._chapters.splice(0,this._chapters.length);this._imageQueue.splice(0,this._imageQueue.length);this._drawingComplete=!1;this._duration=0;c.SPRITESHEET_COLUMN_COUNT=4;this._uiJumpMarkContainer&&this._uiJumpMarkContainer.remove()};a.playerEventReadyHandler=function(){var a=this._player.model.mediaCollection,b=a.getChapterSpriteImage()||"";if(b.trim()&&(this._imageQueue.push(b),
b=a.getChapterSpriteColumns(),!isNaN(b)&&0<b))c.SPRITESHEET_COLUMN_COUNT=b;a=a.getChapterArray()||[];for(b=0;b<a.length;b++){var e=(new d).parse(a[b]);this._chapters.push(e);e.hasPreloadImage()&&this._imageQueue.push(e.getPreloadImageUrl())}0<this._imageQueue.length?this.preloadImage(this._imageQueue.shift()):this.preloadingFinished()};a.preloadImage=function(a){function b(){0<this._imageQueue.length?this.preloadImage(this._imageQueue.shift()):this.preloadingFinished()}e("<img>").attr("src",a).one("load",
function(c){for(var d=a==this._player.model.mediaCollection.getChapterSpriteImage(),e=0,k=-1;e<this._chapters.length;e++){var m=this._chapters[e];!m.hasPreloadImage()&&d&&++k;(m.getPreloadImageUrl()==a||!m.hasPreloadImage()&&d)&&m.setPreloadedImage(c.target,d,k)}b.bind(this).call()}.bind(this)).one("error",function(){b.bind(this).call()}.bind(this))};a.preloadingFinished=function(){this._preloadingFinished=!0;this.draw()};a.playStreamEventHandler=function(){if(!(0<this._duration))this._duration=this._player.getCtrl().getDuration()||
0,0==this._duration?setTimeout(this.playStreamEventHandler.bind(this),100):this.draw()};a.draw=function(){if(this._preloadingFinished&&!(0>=this._duration||this._drawingComplete)){this._drawingComplete=!0;var a=this._player.viewCtrl;this._uiJumpMarkContainer=a.generateDiv(c.CSS_CLASS_MARKER_CONTAINER,a.mainControlbar,a);for(a=0;a<this._chapters.length;a++){var b=this._chapters[a],d=e("<span></span>").addClass(c.CSS_CLASS_MARKER).css("left","calc( "+(100*(b.getSeconds()/this._duration)).toFixed(8)+
"% - "+this._markerWidth/2+"px)").on("click",this.jumpMark_clickHandler.bind(this)).appendTo(this._uiJumpMarkContainer);this._isMobile&&d.addClass("mobile");if(b.hasTitle()||b.hasImage())if(d.on("mouseenter",this.jumpMark_mouseOverHandler.bind(this)),!this._isMobile)d.on("mouseout",this.jumpMark_mouseOutHandler.bind(this))}}};a.jumpMark_clickHandler=function(a){this._isMobile&&clearTimeout(this._currentHoverTimeout);var b=a=e(a.target);do{if(b.hasClass(c.CSS_CLASS_MARKER))break;b=b.parent()}while(null!=
b);a=b||a;this._player.seekTo(this._chapters[a.index()].getSeconds());this._isMobile&&a.empty()};a.jumpMark_mouseOverHandler=function(a){var b=e(a.target);null!=this._currentHoverTarget&&this._currentHoverTarget.empty();this._currentHoverTarget=b;if(this._isMobile)clearTimeout(this._currentHoverTimeout),this._currentHoverTimeout=setTimeout(function(){if(this._currentHoverTarget)null!=this._currentHoverTarget&&this._currentHoverTarget.empty(),this._currentHoverTarget=null}.bind(this),5E3);var d=this._chapters[b.index()];
if(b.hasClass(c.CSS_CLASS_MARKER)){a=e("<div></div>").addClass(c.CSS_CLASS_POPUP).css("display","table");if(d.hasImage()){var j=d.getSpritesheetCoordinates();e("<div></div>").css({margin:"4px",width:j.w,height:j.h,backgroundImage:"url("+d.getImageSrc()+")",backgroundPosition:-j.x+"px "+-j.y+"px"}).appendTo(a)}d.hasTitle()&&e("<p>"+d.getTitle()+"</p>").css({padding:"2px",textAlign:"left",margin:"0px",width:c.TXT_MAX_WIDTH,minWidth:c.TXT_MAX_WIDTH,color:"#FFFFFF",display:"table-cell",verticalAlign:"top"}).appendTo(a);
j=(this._markerWidth-14)/2;e("<span></span>").addClass(c.CSS_CLASS_POPUP_ARROW).css("left",j+"px").fadeIn("slow").appendTo(b);a.fadeIn("slow").appendTo(b);var b=this._uiJumpMarkContainer.parent()[0].getBoundingClientRect(),d=this._currentHoverTarget[0].getBoundingClientRect(),i=d.left+j-b.left+7,j=a.width(),i=i-j/2;0>i?i=0:i+j>b.width&&(i=b.width-j);i+=b.left-d.left;a.css("left",i+"px")}};a.jumpMark_mouseOutHandler=function(a){e(a.target).empty()};b.AddonSprungmarken=c})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(){},c=d.prototype=new b.AbstractCorePlugin;d.CLASS_SUBTITEL="ardplayer-btn-subtitle";d.CLASS_SUBTITEL_PLACEHOLDER="ardplayer-untertitel";d.CLASS_SUBTITLE_SELECTED="toggle";d.ERROR_LOADING_SUBTITLE_XML="Ein Fehler beim Laden der Untertitel-XML ist aufgetreten.";d.EVENT_HIDE_SUBTITLES="AddonUntertitel.hideSubtitles";d.EVENT_SHOW_SUBTITLES="AddonUntertitel.showSubtitles";d.EVENT_TGGL_SUBTITLES="AddonUntertitel.toggleSubtitles";c.super_register=c.register;c.register=function(a){this.super_register(a);
this.ADDON_NAME="AddonUntertitel";this.VERSION="1.2";a=b.GlobalModel.getInstance();a.isWindowsPhone||a.isIPhoneDevice||a.isIPodDevice?this.log("Plugin skipped: AddonUntertitel"):(this.register_event(b.Player.EVENT_INIT,this.eventInitPlayer),this.register_event(b.Player.EVENT_KEYBOARD_RELEASE,this.eventKeyboardRelease),this.register_event(b.Player.EVENT_LOAD_STREAM,this.eventLoadStream),this.register_event(b.Player.EVENT_STOP_STREAM,this.eventStopStream),this.register_event(b.Player.EVENT_END_STREAM,
this.eventEndStream),this.register_event(b.Player.EVENT_UPDATE_STREAM_TIME,this.eventUpdateStreamTime),this.register_event(b.Player.VIEW_RESTORE_DEFAULTS,this.eventViewRestoreDefaults),this.register_event(b.Player.SETUP_VIEW,this.eventSetupView),this.register_event(b.Player.SETUP_VIEW_COMPLETE,this.eventViewSetupComplete),this.register_event(b.Player.VIEW_CTRLBAR_MOVE,this.eventLiftSubtitles),this.register_event(b.Player.TOGGLE_FULLSCREEN,this.eventToggleFullscreen),this.register_event(d.EVENT_SHOW_SUBTITLES,
this.eventShowSubtitles),this.register_event(d.EVENT_HIDE_SUBTITLES,this.eventHideSubtitles),this.register_event(d.EVENT_TGGL_SUBTITLES,this.eventToggleSubtitles),this.log("Plugin registered: AddonUntertitel"))};c.super_dispose=c.dispose;c.dispose=function(){this.subtitleController&&this.subtitleController.dispose();this.subtitleController=null;this.super_dispose()};c.eventToggleFullscreen=function(a){if(this.displaySubtitles&&this.subtitleController&&this.subtitleController._lastCaptioningElement)this.subtitleController._lastCaptioningElement.style=
{},a=e.extend(e.Event(b.SubtitleController.TEXT_VALUE_CHANGED),{changedObject:this.subtitleController._lastCaptioningElement}),e(this.subtitleController).trigger(a)};c.eventShowSubtitles=function(){this.showSubtitles();this.showSubtitleState(!0)};c.eventHideSubtitles=function(){this.hideSubtitles();this.showSubtitleState(!1)};c.eventToggleSubtitles=function(a){this.toggleSubtitles(a?a.preventTrackingPixel||!1:!1)};c.eventSetupView=function(a){this.setupView(a)};c.eventKeyboardRelease=function(a){"u"==
a.shortcut&&(!1===this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_ACTIVATION):!0===this.displaySubtitles&&this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_KEY_SUBTITLE_DEACTIVATION),this.toggleSubtitles(),this.showSubtitleState(this.getISubTitleDivVisible()))};c.eventViewSetupComplete=function(){this.displaySubtitles?this.showSubtitleState(!0):this.showSubtitleState(!1)};c.eventViewRestoreDefaults=function(){this.hideSubtitles()};
c.eventInitPlayer=function(){this.subtitleController=b.SubtitleController.getInstance(this._player);this.subtitleControllerBindEventHandler()};c.eventLoadStream=function(){if(!this._loadTriggered)this._loadTriggered=!0,this.loadSubtitles()};c.eventUpdateStreamTime=function(a){!0==this.getISubTitleDivVisible()&&this.subtitleController.updateTimeFromPlyrCtrl(a.currentTime)};c.eventStopStream=function(){this.hideSubtitles();if(this.ebuSubtitleController)this.ebuSubtitleController._lastCaptioningElement=
null};c.eventEndStream=function(){this.hideSubtitles()};c.eventLiftSubtitles=function(a){!0==this.getISubTitleDivVisible()&&this.subtitlePlaceHolder.css({top:"",bottom:parseInt(a.ctrlBarHeight)})};c.setupView=function(a){function c(a,b,e){g.subtitlePlaceHolder=a.generateDiv(d.CLASS_SUBTITEL_PLACEHOLDER,a.viewport,a,b,e);a.addGeneratedElemetToList(a,d.CLASS_SUBTITEL_PLACEHOLDER,d.CLASS_SUBTITEL_PLACEHOLDER,g.subtitlePlaceHolder,e,!1,!1,!1,!1,!1,!0);g.hideSubtitles();g.subtitlePlaceHolder.off(a.clickEventName).on(a.clickEventName,
function(){g._player.getCtrl().togglePlay();return!1}).attr("aria-live","off");return g.subtitlePlaceHolder}function f(a,c,f){if(!e.isBlank(j.getSubtitleUrl())&&!j.getIsLive()){var i=function(a){if(13==a.keyCode)return a.preventDefault(),h(a,!1)}.bind(this),h=function(a,c){if(!1!==c)try{g.subtitle.blur()}catch(d){}!1===g.displaySubtitles?g._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_ACTIVATION):!0===g.displaySubtitles&&g._player.pixelController.triggerCustomPixel(b.PlayerPixelController.IA_MOUSE_SUBTITLE_DEACTIVATION);
g.toggleSubtitles();return g._player.viewCtrl.tabFadePrevention=!1}.bind(this);g.subtitle=a.generateButton(d.CLASS_SUBTITEL,k,a,c,f).attr({title:"Untertitel ein-/ausblenden [(STRG +) U]",role:"menuitem","aria-pressed":!1,tabindex:"0"}).on("keydown",i).on(a.clickEventName,h).on("mouseover mouseout touchstart touchend",function(a){a.preventDefault();e(a.target).toggleClass("hover")});return g.subtitle}return null}var g=this,j=this._player.model.mediaCollection,i=a.controller,k=a.container;this.displaySubtitles=
this._player.model.playerConfig.getShowSubtitelAtStart();a=b.GlobalModel.getInstance();if(a.hasSubtitlePreference())this.displaySubtitles=a.getSubtitleEnabled();this.displaySubtitles=this.displaySubtitles&&!this._player.model.mediaCollection.getIsLive();j.getType()===b.MediaCollection.TYPE_VIDEO&&(f(i),c(i))};c.getISubTitleDivVisible=function(){var a=!1;this.subtitle&&(a=this.subtitle.hasClass(d.CLASS_SUBTITLE_SELECTED));return a};c.hideSubtitles=function(){this.subtitlePlaceHolder&&this.subtitlePlaceHolder.hideWithClass()};
c.showSubtitles=function(){this.subtitlePlaceHolder&&this.subtitlePlaceHolder.showWithClass()};c.showSubtitleState=function(a){this.displaySubtitles=a;if(this.subtitle){switch(a){case !0:this.subtitle.addClass(d.CLASS_SUBTITLE_SELECTED);break;case !1:this.subtitle.removeClass(d.CLASS_SUBTITLE_SELECTED)}this.subtitle.attr({"aria-pressed":a})}};c.toggleSubtitles=function(a){if(this._player&&this._player.getCtrl()){this.displaySubtitles=!this.displaySubtitles;b.GlobalModel.getInstance().setSubtitleEnabled(this.displaySubtitles);
var c=this.displaySubtitles;e.each(b.PlayerModel.getAllPlayer(this._player),function(a,b){b.dispatchCustomEvent(c?d.EVENT_SHOW_SUBTITLES:d.EVENT_HIDE_SUBTITLES)});this.showSubtitleState(this.displaySubtitles);var f=this._player.getCtrl();this.displaySubtitles?(f.showSubtitles(),this.showSubtitles()):(f.hideSubtitles(),this.hideSubtitles());a||(this.displaySubtitles?this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_ACTIVATION):this._player.pixelController.triggerCustomPixel(b.PlayerPixelController.SUPER_SUBTITLE_DEACTIVATION))}};
c.loadSubtitles=function(){var a=this._player.model.mediaCollection;e.isBlank(a.getSubtitleUrl())?this.displaySubtitles=!1:this.subtitleController.loadTrackXML(this._player.viewCtrl.viewport,a.getSubtitleUrl())};c.subtitleControllerBindEventHandler=function(){var a=this;e(this.subtitleController).on(b.SubtitleController.TEXT_VALUE_CHANGED,function(b){if(a.subtitlePlaceHolder){var c=e.extend({},b.changedObject.style),d=e(a.subtitlePlaceHolder);d.empty();d.attr("style",null);var j=c.backgroundColor;
void 0===j&&(j="black");c.backgroundColor=void 0;var i=e('<div class="ardplayer-hintergrund"></div>').css("backgroundColor",j);void 0===c.color&&(c.color="white");var k=e('<div class="ardplayer-inhalt"></div>').css(c).appendTo(d);i.appendTo(d);k.html(b.changedObject.content);e(d).children().children().css({paddingLeft:"10%",paddingRight:"10%"});b=a._player.viewCtrl.viewport.height()/15;10>b?(e(d).children().css("visibility","hidden"),e(".ardplayer-btn-subtitle").css("display","none")):(e(d).children().css("visibility",
"visible"),e(".ardplayer-btn-subtitle").css("display","inline-block"));e(d).children().css("font-size",b);b=parseInt(a._player.viewCtrl.mainControlbar.css("bottom"))+parseInt(a._player.viewCtrl.mainControlbar.css("height"));e(d).css({top:"",bottom:b});var m=e(k).css("top"),l=0,p=100,n=function(){0!=--p&&(l=k.outerHeight(),20<l?("auto"!=m&&(l=-parseInt(m,10)+l),e(i).css({height:l,top:m})):setTimeout(n,30))};n();a.displaySubtitles&&a.subtitlePlaceHolder.showWithClass()}});e(this.subtitleController).on(b.SubtitleController.HIDE_SUBTITLES,
function(){a.subtitlePlaceHolder&&a.subtitlePlaceHolder.hideWithClass()});e(this.subtitleController).on(b.SubtitleController.ERROR_LOADING_XML,function(){a.subtitle&&(a.subtitle.hideWithClass(),a._player.errorCtrl.throwError(d.ERROR_LOADING_SUBTITLE_XML,b.ErrorController.IS_CRITICAL_NO),e(a.subtitleController).off())})};b.AddonUntertitel=d})(ardplayer,ardplayer.jq,ardplayer.console);
(function(b,e){var d=function(a){if(void 0==d.playerIDs)d.playerIDs={};if(void 0==d.players)d.players=[];var c=void 0;a&&a instanceof b.Player&&(c=a.getId());void 0==c&&b.ErrorController.getInstance().throwError(b.ErrorController.NO_PLAYER_DEFINED,b.ErrorController.IS_CRITICAL_YES);if(d.playerIDs[c])return d.playerIDs[c];d.playerIDs[c]=this;d.players.push(a);this.playerID=c;this.player=a;this.initialize()};d.getInstance=function(a){return new d(a)};d.resetSingleton=function(){d.instance=void 0};var c=
d.prototype;c.initialize=function(){this._lastCaptioningElement=this.trackData=this.subTitleObjects=this.loadedXML=this.subTitleURL=this.playingPlayer=null};c.dispose=function(){this.playerID&&(d.playerIDs[this.playerID]=null)};c.loadTrackXML=function(a,c){this.trackData={};this.trackData.captions=[];this.playingPlayer=a;this.subTitleURL=c;e.ajax({type:"GET",url:c,dataType:"xml",encoding:"UTF-8",error:b.Delegate.create(this,this.xmlError),complete:b.Delegate.create(this,this.xmlComplete),success:b.Delegate.create(this,
this.xmlSuccess)})};c.xmlComplete=function(){};c.xmlError=function(){h(this,d.ERROR_LOADING_XML)};var a={"text/srt":["text","parseSrt"],"application/ttaf+xml":["xml","parseDfxp"]};c.xmlSuccess=function(b,c){this.loadedXML=b;if(null!=b&&"success"==c){var d=e('<li><a class="track" type="application/ttaf+xml" href="'+this.subTitleURL+'" lang="de"  data-enabled="enabled" >DFXP/ttml file</a></li>');e(this.playingPlayer).append(d.hideWithClass());var d=e(".track").attr("type")||"text/srt",d=a[d],i=[],k=
this,m=function(a){e.each(a,function(a,b){i.push(b);k.trackData.captions.push(b)});k.subTitleObjects=i};try{e[d[1]](b,function(a){k.trackData.captions=a;m(a)},(e(".track")[0].attributes["data-sanitize"]||{}).specified)}catch(l){}}};c.updateTimeFromPlyrCtrl=function(a){for(var b=this.trackData.captions,c=null,e=0;e<b.length;e++){var k=b[e];if(a>=k.start&&a<=k.end){c=k;break}}if(this._lastCaptioningElement!=c)this._lastCaptioningElement=c,null!=c?h(this,d.TEXT_VALUE_CHANGED,{changedObject:c}):h(this,
d.HIDE_SUBTITLES,{changedObject:null})};e.backgroundEach=function(a,b,c){var d=0,e=a.length,m=function(){for(var l=(new Date).getTime();d<e;d++)if(b(d,a[d],a),100<(new Date).getTime()-l){setTimeout(m,50);break}d>=e-1&&c(a,d,e)};m()};e.parseDfxp=function(){var a=function(a){a=(a||"").split(":");return 3===a.length?(a=3600*parseInt(a[0],10)+60*parseInt(a[1],10)+parseInt(a[2],10),a-=36E3,isNaN(a)?!1:a):!1},b=document,c={span:1,div:1,p:1,em:1,strong:1,br:1},d=function(a){for(var a=a.childNodes,f=b.createElement("div"),
l,h,n,o=0,r=a.length;o<r;o++)if(3===a[o].nodeType)f.appendChild(b.createTextNode(a[o].data));else if(1===a[o].nodeType&&c[a[o].nodeName.toLowerCase()]&&(l=b.createElement(a[o].nodeName),f.appendChild(l),h=d(a[o]),n=setSpanStyle(a[o]),h&&(l.innerHTML=h,n)))for(key in e(l).css("display","block"),n)e(l).css(key,n[key]);return f.innerHTML};setSpanStyle=function(a){for(var b={},c=0;c<a.attributes.length;c++)if(null!==a.attributes[c].nodeName.match(/tts:.+/i))b[a.attributes[c].nodeName.replace(/tts:/gi,
"")]=a.attributes[c].nodeValue;return b};getStylesHeader=function(a){for(var a=e("head",a).find("styling").find("style"),b={},c=0;c<a.length;c++){for(var d={},f=0;f<a[c].attributes.length;f++)if(null!==a[c].attributes[f].nodeName.match(/tts:.+/i))d[a[c].attributes[f].nodeName.replace(/tts:/gi,"")]=a[c].attributes[f].nodeValue;b[e(a[c]).attr("id")]=d}return b};setBodyStyle=function(a){var b={};if(void 0!=e("head",a).find("#"+e("body",a).attr("style"))[0])for(var a=e("head",a).find("#"+e("body",a).attr("style"))[0].attributes,
c=0;c<a.length;c++)if(a[c].nodeName.replace(/tts:/gi,""),null!==a[c].nodeName.match(/tts:.+/i))b[a[c].nodeName.replace(/tts:/i,"")]=a[c].nodeValue;return b};setStyle=function(a,b,c,d){var f=a.getAttribute("style");e("head",d).find("styling").find("#"+f);b=clone(b);b=clone(c[a.getAttribute("style")]);for(c=0;c<a.attributes.length;c++)if(null!==a.attributes[c].nodeName.match(/tts:.+/i))b[a.attributes[c].nodeName.replace(/tts:/i,"")]=a.attributes[c].nodeValue;return b};clone=function(a){return new function(a){for(var b in a)this[b]=
a[b]}(a)};return function(b,c){var g=e("p, div, span",b).filter("[begin][end]"),h=[],j,o,r,t,u,s;s=getStylesHeader(b);u=setBodyStyle(b);e.backgroundEach(g,function(c){o=a(g[c].getAttribute("begin"));j=a(g[c].getAttribute("end"));t=setStyle(g[c],u,s,b);!1!==o&&!1!==j&&(r=d(g[c])||"",h.push({content:r,start:o,end:j,style:t}))},function(){c(h)})}}();var h=function(a,b,c){b=e.extend(e.Event(b),c);e(a).trigger(b)};d.TEXT_VALUE_CHANGED="textValueChanged";d.HIDE_SUBTITLES="hideSubtitles";d.ERROR_LOADING_XML=
"errorLoadingXml";b.SubtitleController=d})(ardplayer,ardplayer.jq,ardplayer.console);