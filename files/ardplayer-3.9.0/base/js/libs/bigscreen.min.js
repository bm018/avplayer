/*! BigScreen
 * v2.0.5 - 2015-05-02
 *
 * Copyright 2015 Brad Dougherty <me@brad.is>; MIT License
 *
 * Fixed by Florian Diesner <fd@nettrek.de> on 2015-11-06
 * - exit() now respects exit.fn() call of html5 video element
 *   instead of generally calling the function in document.
 *
 */!function(e,n,t){"use strict";function r(e){var n=null;if("VIDEO"===e.tagName)n=e;else{var t=e.getElementsByTagName("video");t[0]&&(n=t[0])}return n}function l(e){var n=r(e);if(n&&n.webkitEnterFullscreen){try{n.readyState<n.HAVE_METADATA?(n.addEventListener("loadedmetadata",function l(){n.removeEventListener("loadedmetadata",l,!1),n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")},!1),n.load()):(n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")),s=n}catch(t){return E("not_supported",e)}return!0}return E(void 0===c.request?"not_supported":"not_enabled",e)}function o(){h.element||(v(),u())}function i(){t&&"webkitfullscreenchange"===c.change&&window.addEventListener("resize",o,!1)}function u(){t&&"webkitfullscreenchange"===c.change&&window.removeEventListener("resize",o,!1)}var a=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,c=function(){var e=n.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},r={};for(var l in t)for(var o=0,i=t[l].length;i>o;o++)if(t[l][o]in e||t[l][o]in n||"on"+t[l][o].toLowerCase()in n){r[l]=t[l][o];break}return r}(),s=null,d=null,f=function(){},m=[],b=!1;navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Chrome")>-1&&(b=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0);var g=function(e){var n=m[m.length-1];n&&(e!==n.element&&e!==s||!n.hasEntered)&&("VIDEO"===e.tagName&&(s=e),1===m.length&&h.onenter(h.element),n.enter.call(n.element,e||n.element),n.hasEntered=!0)},v=function(){!s||d||a||(s.setAttribute("controls","controls"),s.removeAttribute("controls")),s=null,d=null;var e=m.pop();e&&(e.exit.call(e.element),h.element||(m.forEach(function(e){e.exit.call(e.element)}),m=[],h.onexit()))},E=function(e,n){if(m.length>0){var t=m.pop();n=n||t.element,t.error.call(n,e),h.onerror(n,e)}},h={request:function(e,r,o,i){if(e=e||n.body,m.push({element:e,enter:r||f,exit:o||f,error:i||f}),void 0===c.request)return void l(e);if(t&&n[c.enabled]===!1)return void l(e);if(b!==!1&&32>b)return void l(e);if(t&&void 0===c.enabled)return c.enabled="webkitFullscreenEnabled",e[c.request](),void setTimeout(function(){n[c.element]?n[c.enabled]=!0:(n[c.enabled]=!1,l(e))},250);try{e[c.request](),setTimeout(function(){n[c.element]||E(t?"not_enabled":"not_allowed",e)},1000)}catch(u){E("not_enabled",e)}},exit:function(){u(),"function"==typeof h.element[c.exit]&&h.element[c.exit](),"function"==typeof n[c.exit]&&n[c.exit]()},toggle:function(e,n,t,r){h.element?h.exit():h.request(e,n,t,r)},videoEnabled:function(e){if(h.enabled)return!0;e=e||n.body;var t=r(e);return t&&void 0!==t.webkitSupportsFullscreen?t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen:!1},onenter:f,onexit:f,onchange:f,onerror:f};try{Object.defineProperties(h,{element:{enumerable:!0,get:function(){return s&&s.webkitDisplayingFullscreen?s:n[c.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"!==c.exit||t?b!==!1&&32>b?!1:n[c.enabled]||!1:!0}}}),c.change&&n.addEventListener(c.change,function(){if(h.onchange(h.element),h.element){var e=m[m.length-2];e&&e.element===h.element?v():(g(h.element),i())}else v()},!1),n.addEventListener("webkitbeginfullscreen",function(e){var n=!0;if(m.length>0)for(var t=0,l=m.length;l>t;t++){var o=r(m[t].element);if(o===e.srcElement){n=!1;break}}n&&m.push({element:e.srcElement,enter:f,exit:f,error:f}),h.onchange(e.srcElement),g(e.srcElement)},!0),n.addEventListener("webkitendfullscreen",function(e){h.onchange(e.srcElement),v(e.srcElement)},!0),c.error&&n.addEventListener(c.error,function(){E("not_allowed")},!1)}catch(w){h.element=null,h.enabled=!1}"function"==typeof define&&define.amd?define(function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:e.BigScreen=h}(this,document,self!==top);